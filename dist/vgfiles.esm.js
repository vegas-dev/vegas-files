// @vegas-VGFiles v1.1.1
class e{constructor(e,t={}){if(this.container=e||void 0,this.classes={container:"vg-files",label:"vg-files-label",info:"vg-files-info",images:"vg-files-info--images",list:"vg-files-info--list",fake:"vg-files-fake"},this.settings=Object.assign({limits:{count:0,sizes:0},isImage:!1,isInfo:!0,types:["image/png","image/jpeg","image/bmp","image/ico","image/gif","image/jfif","image/tiff"]},t),this.files=[],this.container){this.id=this.container.querySelector("[data-vg-toggle]").getAttribute("id")||void 0,this.name=this.container.querySelector("[data-vg-toggle]").getAttribute("name")||void 0,this.accept=this.container.querySelector("[data-vg-toggle]").getAttribute("accept")||void 0,this.settings.isImage=this.container.dataset.imagePreview||!1,this.settings.Info="false"!==this.container.dataset.infoList;const s=this;function i(e,t,i){document.addEventListener(e,(function(e){let n=s.container.querySelectorAll(t),l=e.target,a=-1;for(;l&&-1===(a=Array.prototype.indexOf.call(n,l));)l=l.parentElement;a>-1&&function(){"function"==typeof i&&i(l),e.preventDefault()}.call(l,e)}))}i("change",'[data-vg-toggle="files"]',(function(e){s.change(e)})),i("click",'[data-dismiss="vg-files"]',(function(e){s.clear(!0)}))}}change(e){const t=this;let s=e.files,i=[];if(t.clear(),s.length){if(1!==t.settings.limits.count){e.removeAttribute("id"),e.removeAttribute("data-vg-toggle"),e.classList.add(t.classes.fake),e.onchange=null;let s=t.accept?'accept="'+t.accept+'"':"";t.container.insertAdjacentHTML("beforeEnd",'<input type="file" name="'+t.name+'" id="'+t.id+'" data-vg-toggle="files" '+s+" multiple>")}if(i=t.append(s),i.length){let e=t.container.querySelector("."+this.classes.info);e.classList.add("show");let s=e.querySelector("."+t.classes.info+"--wrapper-count");s&&(s.innerHTML=i.length+"<span>["+t.getSizes(i,!0)+"]</span>"),t.setImages(i),t.setInfoList(i)}}}append(e){const t=this;return t.files.push(e),function(e,t){let s=[];for(let i=0;i<=e.length-1;i++){let n=1;for(const l of e[i])0===t?s.push(l):n<=t&&s.unshift(l),n++}t>0&&s.length>t&&s.splice(t,s.length-t);return s}(t.files,t.settings.limits.count)}setImages(e){let t=this;if(t.settings.isImage){const s=t.container.querySelector("."+t.classes.info);if(s){let i=s.querySelector("."+t.classes.images);i||(i=document.createElement("div"),i.classList.add(t.classes.images),s.prepend(i));for(const t of e)if(this.checkType(t.type)){let e=URL.createObjectURL(t);i.insertAdjacentHTML("beforeEnd",'<span><img src="'+e+'" alt="#"></span>')}}}}setInfoList(e){let t=this;if(t.settings.isInfo){const s=t.container.querySelector("."+t.classes.info);if(s){let i=document.createElement("div");i.classList.add(t.classes.list),s.append(i);let n=1;for(const t of e){let e=this.getSizes(t.size);i.insertAdjacentHTML("beforeEnd","<li><span>"+n+".</span><span>"+t.name+"</span><span>["+e+"]</span></li>"),n++}}}}checkType(e){return this.settings.types.includes(e)}getSizes(e,t=!1){const s=this;let i=e/1024,n=i/1024,l=n/1024,a=l/1024,o=0;if(o=i<=1024?i.toFixed(3)+" Kb":i>=1024&&n<=1024?n.toFixed(3)+" Mb":n>=1024&&l<=1024?l.toFixed(3)+" Gb":a.toFixed(3)+" Tb",t){let t=[];e.map((function(e){t.push(e.size)})),o=t.reduce((function(e,t){return e+t})),o=s.getSizes(o)}return o}clear(e=!1){const t=this;let s=t.container.querySelector("."+this.classes.info);if(s){if(t.settings.isImage){let e=s.querySelector("."+this.classes.images);if(e){let t=e.querySelectorAll("span");if(t.length)for(const e of t)e.parentNode.removeChild(e)}}if(t.settings.isInfo){let e=s.querySelector("."+this.classes.list);if(e){let t=e.querySelectorAll("li");if(t.length)for(const e of t)e.parentNode.removeChild(e)}}}if(e){t.container.querySelector('[type="file"]').value="";let e=t.container.querySelectorAll("."+t.classes.fake);if(e.length)for(const t of e)t.remove();s&&s.classList.remove("show"),t.files=[]}}}document.addEventListener("DOMContentLoaded",(function(){let t=document.querySelectorAll(".vg-files");if(t.length)for(const s of t)new e(s)}));export{e as VGFiles};
