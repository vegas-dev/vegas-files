// @vegas-VGFiles v1.1.2
const e=function(...t){const s=e=>e&&"object"==typeof e;return t.reduce(((t,i)=>(Object.keys(i).forEach((n=>{const o=t[n],l=i[n];Array.isArray(o)&&Array.isArray(l)?t[n]=o.concat(...l):s(o)&&s(l)?t[n]=e(o,l):t[n]=l})),t)),{})},t=function(e,t,s){document.addEventListener(e,(function(e){let i=document.body.querySelectorAll(t),n=e.target,o=-1;for(;n&&-1===(o=Array.prototype.indexOf.call(i,n));)n=n.parentElement;o>-1&&function(){"function"==typeof s&&s(n),e.preventDefault()}.call(n,e)}))},s={limits:{count:0,sizes:0},isImage:!1,isInfo:!0,types:["image/png","image/jpeg","image/bmp","image/ico","image/gif","image/jfif","image/tiff"]};class i{constructor(t,i={}){this.container=t||void 0,this.classes={container:"vg-files",label:"vg-files-label",info:"vg-files-info",images:"vg-files-info--images",list:"vg-files-info--list",fake:"vg-files-fake"},this.settings=e(s,i),this.files=[],this.container&&this.init()}init(){const e=this;e.id=e.container.querySelector("[data-vg-toggle]").getAttribute("id")||void 0,e.name=e.container.querySelector("[data-vg-toggle]").getAttribute("name")||void 0,e.accept=e.container.querySelector("[data-vg-toggle]").getAttribute("accept")||void 0,e.settings.isImage="true"===e.container.dataset.imagePreview||!1,e.settings.isInfo="false"!==e.container.dataset.infoList,t("change",'[data-vg-toggle="files"]',(function(t){e.change(t)})),t("click",'[data-dismiss="vg-files"]',(function(t){e.clear(!0)}))}change(e){const t=this;let s=e.files,i=[];if(t.clear(),s.length){if(1!==t.settings.limits.count){e.removeAttribute("id"),e.removeAttribute("data-vg-toggle"),e.classList.add(t.classes.fake),e.onchange=null;let s=t.accept?'accept="'+t.accept+'"':"";t.container.insertAdjacentHTML("beforeEnd",'<input type="file" name="'+t.name+'" id="'+t.id+'" data-vg-toggle="files" '+s+" multiple>")}if(i=t.append(s),i.length){let e=t.container.querySelector("."+this.classes.info);e.classList.add("show");let s=e.querySelector("."+t.classes.info+"--wrapper-count");s&&(s.innerHTML=i.length+"<span>["+t.getSizes(i,!0)+"]</span>"),t.setImages(i),t.setInfoList(i)}}}append(e){const t=this;return t.files.push(e),function(e,t){let s=[];for(let i=0;i<=e.length-1;i++){let n=1;for(const o of e[i])0===t?s.push(o):n<=t&&s.unshift(o),n++}t>0&&s.length>t&&s.splice(t,s.length-t);return s}(t.files,t.settings.limits.count)}setImages(e){let t=this;if(t.settings.isImage){const s=t.container.querySelector("."+t.classes.info);if(s){let i=s.querySelector("."+t.classes.images);i||(i=document.createElement("div"),i.classList.add(t.classes.images),s.prepend(i));for(const t of e)if(this.checkType(t.type)){let e=URL.createObjectURL(t);i.insertAdjacentHTML("beforeEnd",'<span><img src="'+e+'" alt="#"></span>')}}}}setInfoList(e){let t=this;if(t.settings.isInfo){const s=t.container.querySelector("."+t.classes.info);if(s){let i=s.querySelector("."+t.classes.list);i||(i=document.createElement("ul"),i.classList.add(t.classes.list),s.append(i));let n=1;for(const t of e){let e=this.getSizes(t.size);i.insertAdjacentHTML("beforeEnd","<li><span>"+n+".</span><span>"+t.name+"</span><span>["+e+"]</span></li>"),n++}}}}checkType(e){return this.settings.types.includes(e)}getSizes(e,t=!1){const s=this;let i=e/1024,n=i/1024,o=n/1024,l=o/1024,a=0;if(a=i<=1024?i.toFixed(3)+" Kb":i>=1024&&n<=1024?n.toFixed(3)+" Mb":n>=1024&&o<=1024?o.toFixed(3)+" Gb":l.toFixed(3)+" Tb",t){let t=[];e.map((function(e){t.push(e.size)})),a=t.reduce((function(e,t){return e+t})),a=s.getSizes(a)}return a}clear(e=!1){const t=this;let s=t.container.querySelector("."+t.classes.info);if(s){if(t.settings.isImage){let e=s.querySelector("."+t.classes.images);if(e){let t=e.querySelectorAll("span");if(t.length)for(const e of t)e.parentNode.removeChild(e)}}if(t.settings.isInfo){let e=s.querySelector("."+t.classes.list);if(e){console.log(e);let t=e.querySelectorAll("li");if(t.length)for(const e of t)e.parentNode.removeChild(e)}}}if(e){t.container.querySelector('[type="file"]').value="";let e=t.container.querySelectorAll("."+t.classes.fake);if(e.length)for(const t of e)t.remove();s&&s.classList.remove("show"),t.files=[]}}}document.addEventListener("DOMContentLoaded",(function(){let e=document.querySelectorAll(".vg-files");if(e.length)for(const t of e)new i(t)}));export{i as VGFiles};
