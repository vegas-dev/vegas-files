// @vegas-VGFiles v1.1.0
class e{constructor(e,t={}){if(this.container=e||void 0,this.classes={container:"vg-files",label:"vg-files-label",info:"vg-files-info",images:"vg-files-info--images",list:"vg-files-info--list",fake:"vg-files-fake"},this.settings=Object.assign({limits:{count:0,sizes:0},isImage:!1,isInfo:!0,types:["image/png","image/jpeg","image/bmp","image/ico","image/gif","image/jfif","image/tiff"]},t),this.files=[],this.container){this.id=this.container.querySelector("[data-vg-toggle]").getAttribute("id")||void 0,this.name=this.container.querySelector("[data-vg-toggle]").getAttribute("name")||void 0,this.accept=this.container.querySelector("[data-vg-toggle]").getAttribute("accept")||void 0;const e=this;document.addEventListener("change",(function(t){let i=e.container.querySelectorAll('[data-vg-toggle="files"]'),s=t.target,n=-1;for(;s&&-1===(n=Array.prototype.indexOf.call(i,s));)s=s.parentElement;n>-1&&function(){e.change(s)}.call(s,t)}))}}change(e){const t=this;let i=e.files,s=[];if(t.clear(),i.length){if(1!==t.settings.limits.count){e.removeAttribute("id"),e.removeAttribute("data-vg-toggle"),e.classList.add(t.classes.fake),e.onchange=null;let i=t.accept?'accept="'+t.accept+'"':"";t.container.insertAdjacentHTML("beforeEnd",'<input type="file" name="'+t.name+'" id="'+t.id+'" data-vg-toggle="files" '+i+" multiple>")}if(s=t.append(i),s.length){let e=t.container.querySelector("."+this.classes.info);e.classList.add("show");let i=e.querySelector("."+t.classes.info+"--wrapper-count");i&&(i.innerHTML=s.length+"<span>["+t.getSizes(s,!0)+"]</span>");for(let i=0;i<=s.length-1;i++)if(t.settings.isImage&&this.checkType(s[i].type)){let n=URL.createObjectURL(s[i]);e.querySelector("."+t.classes.images).append('<span><img src="'+n+'" alt="#"></span>')}}}}append(e){const t=this;return t.files.push(e),function(e,t){let i=[];for(let s=0;s<=e.length-1;s++){let n=1;for(const l of e[s])0===t?i.push(l):n<=t&&i.unshift(l),n++}t>0&&i.length>t&&i.splice(t,i.length-t);return i}(t.files,t.settings.limits.count)}checkType(e){return this.settings.types.includes(e)}getSizes(e,t=!1){const i=this;let s=e/1024,n=s/1024,l=n/1024,o=l/1024,a=0;if(a=s<=1024?s.toFixed(3)+" Kb":s>=1024&&n<=1024?n.toFixed(3)+" Mb":n>=1024&&l<=1024?l.toFixed(3)+" Gb":o.toFixed(3)+" Tb",t){let t=[];e.map((function(e){t.push(e.size)})),a=t.reduce((function(e,t){return e+t})),a=i.getSizes(a)}return a}clear(){const e=this;let t=e.container.querySelector("."+this.classes.info);if(t){if(e.settings.isImage){let e=t.querySelector("."+this.classes.images);if(e){let t=e.querySelectorAll("span");if(t.length)for(const e of t)e.parentNode.removeChild(e)}}if(e.settings.isInfo){let e=t.querySelector("."+this.classes.list);if(e){let t=e.querySelectorAll("li");if(t.length)for(const e of t)e.parentNode.removeChild(e)}}}}}document.addEventListener("DOMContentLoaded",(function(){let t=document.querySelectorAll(".vg-files");if(t.length)for(const i of t)new e(i)}));export{e as VGFiles};
