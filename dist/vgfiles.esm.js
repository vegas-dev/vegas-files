// @vegas-VGFiles v1.1.0
class e{constructor(e,t={}){if(this.container=e||void 0,this.classes={container:"vg-files",label:"vg-files-label",info:"vg-files-info",images:"vg-files-info--images",list:"vg-files-info--list",fake:"vg-files-fake"},this.settings=Object.assign({limits:{count:0,sizes:0},isImage:!1,isInfo:!0,types:["image/png","image/jpeg","image/bmp","image/ico","image/gif","image/jfif","image/tiff"]},t),this.files=[],this.container){this.id=this.container.querySelector("[data-vg-toggle]").getAttribute("id")||void 0,this.name=this.container.querySelector("[data-vg-toggle]").getAttribute("name")||void 0,this.accept=this.container.querySelector("[data-vg-toggle]").getAttribute("accept")||void 0,this.settings.isImage=this.container.dataset.imagePreview||!1,this.settings.Info="false"!==this.container.dataset.infoList;const i=this;function s(e,t,s){document.addEventListener(e,(function(e){let n=i.container.querySelectorAll(t),l=e.target,a=-1;for(;l&&-1===(a=Array.prototype.indexOf.call(n,l));)l=l.parentElement;a>-1&&function(){"function"==typeof s&&s(l),e.preventDefault()}.call(l,e)}))}s("change",'[data-vg-toggle="files"]',(function(e){i.change(e)})),s("click",'[data-dismiss="vg-files"]',(function(e){i.clear("all")}))}}change(e){const t=this;let i=e.files,s=[];if(t.clear(),i.length){if(1!==t.settings.limits.count){e.removeAttribute("id"),e.removeAttribute("data-vg-toggle"),e.classList.add(t.classes.fake),e.onchange=null;let i=t.accept?'accept="'+t.accept+'"':"";t.container.insertAdjacentHTML("beforeEnd",'<input type="file" name="'+t.name+'" id="'+t.id+'" data-vg-toggle="files" '+i+" multiple>")}if(s=t.append(i),s.length){let e=t.container.querySelector("."+this.classes.info);e.classList.add("show");let i=e.querySelector("."+t.classes.info+"--wrapper-count");i&&(i.innerHTML=s.length+"<span>["+t.getSizes(s,!0)+"]</span>"),t.setImages(s),t.setInfoList(s)}}}append(e){const t=this;return t.files.push(e),function(e,t){let i=[];for(let s=0;s<=e.length-1;s++){let n=1;for(const l of e[s])0===t?i.push(l):n<=t&&i.unshift(l),n++}t>0&&i.length>t&&i.splice(t,i.length-t);return i}(t.files,t.settings.limits.count)}setImages(e){let t=this;if(t.settings.isImage){const i=t.container.querySelector("."+t.classes.info);if(i){let s=document.createElement("div");s.classList.add(t.classes.images),i.prepend(s);for(const t of e)if(this.checkType(t.type)){let e=URL.createObjectURL(t);s.insertAdjacentHTML("beforeEnd",'<span><img src="'+e+'" alt="#"></span>')}}}}setInfoList(e){let t=this;if(t.settings.isInfo){const i=t.container.querySelector("."+t.classes.info);if(i){let s=document.createElement("div");s.classList.add(t.classes.list),i.append(s);let n=1;for(const t of e){let e=this.getSizes(t.size);s.insertAdjacentHTML("beforeEnd","<li><span>"+n+".</span><span>"+t.name+"</span><span>["+e+"]</span></li>"),n++}}}}checkType(e){return this.settings.types.includes(e)}getSizes(e,t=!1){const i=this;let s=e/1024,n=s/1024,l=n/1024,a=l/1024,o=0;if(o=s<=1024?s.toFixed(3)+" Kb":s>=1024&&n<=1024?n.toFixed(3)+" Mb":n>=1024&&l<=1024?l.toFixed(3)+" Gb":a.toFixed(3)+" Tb",t){let t=[];e.map((function(e){t.push(e.size)})),o=t.reduce((function(e,t){return e+t})),o=i.getSizes(o)}return o}clear(e=!1){const t=this;let i=t.container.querySelector("."+this.classes.info);if(i){if(t.settings.isImage){let e=i.querySelector("."+this.classes.images);if(e){let t=e.querySelectorAll("span");if(t.length)for(const e of t)e.parentNode.removeChild(e)}}if(t.settings.isInfo){let e=i.querySelector("."+this.classes.list);if(e){let t=e.querySelectorAll("li");if(t.length)for(const e of t)e.parentNode.removeChild(e)}}}if(e){t.container.querySelector('[type="file"]').value="";let e=t.container.querySelectorAll("."+t.classes.fake);if(e.length)for(const t of e)t.remove();i&&i.classList.remove("show"),t.files=[]}}}document.addEventListener("DOMContentLoaded",(function(){let t=document.querySelectorAll(".vg-files");if(t.length)for(const i of t)new e(i)}));export{e as VGFiles};
