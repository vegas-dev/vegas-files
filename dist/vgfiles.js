var vg;(()=>{"use strict";var e={d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{VGFiles:()=>o});const s=function(...e){const t=e=>e&&"object"==typeof e;return e.reduce(((e,i)=>(Object.keys(i).forEach((n=>{const o=e[n],a=i[n];Array.isArray(o)&&Array.isArray(a)?e[n]=o.concat(...a):t(o)&&t(a)?e[n]=s(o,a):e[n]=a})),e)),{})},i={limits:{count:0,sizes:0},isImage:!1,isInfo:!0,types:["image/png","image/jpeg","image/bmp","image/ico","image/gif","image/jfif","image/tiff","image/webp"]};class n{constructor(e,t={}){this.container=e||void 0,this.classes={container:"vg-files",label:"vg-files-label",info:"vg-files-info",images:"vg-files-info--images",list:"vg-files-info--list",fake:"vg-files-fake"},this.settings=s(i,t),this.files=[],this.container&&(this.isInitChange=!1,this.init())}init(){const e=this;e.id=e.container.querySelector("[data-vg-toggle]").getAttribute("id")||void 0,e.name=e.container.querySelector("[data-vg-toggle]").getAttribute("name")||void 0,e.accept=e.container.querySelector("[data-vg-toggle]").getAttribute("accept")||void 0,e.settings.isImage="true"===e.container.dataset.imagePreview||!1,e.settings.isInfo="false"!==e.container.dataset.infoList,e.settings.limits.count=parseInt(e.container.dataset.limitCount)||0,e.settings.limits.sizes=parseInt(e.container.dataset.limitSize)||0,e.changeListener(),e.container.querySelector('[data-dismiss="vg-files"]').onclick=function(){return e.clear(!0),!1}}change(e){const t=this;let s=e.files,i=[];if(t.clear(),s.length){if(1!==t.settings.limits.count){e.removeAttribute("id"),e.removeAttribute("data-vg-toggle"),e.classList.add(t.classes.fake),e.onchange=null;let s=t.accept?'accept="'+t.accept+'"':"";t.container.insertAdjacentHTML("beforeEnd",'<input type="file" name="'+t.name+'" id="'+t.id+'" data-vg-toggle="files" '+s+" multiple>"),t.changeListener()}if(i=t.append(s),i.length){let e=t.container.querySelector("."+this.classes.info);e.classList.add("show");let s=e.querySelector("."+t.classes.info+"--wrapper-count");s&&(s.innerHTML=i.length+"<span>["+t.getSizes(i,!0)+"]</span>"),t.setImages(i),t.setInfoList(i)}}}changeListener(){const e=this;[...e.container.querySelectorAll('[data-vg-toggle="files"]')].forEach((function(t){t.addEventListener("change",(function(){e.change(this)}))}))}append(e){const t=this;return t.files.push(e),function(e,t){let s=[];for(let i=0;i<=e.length-1;i++){let n=1;for(const o of e[i])0===t?s.push(o):n<=t&&s.unshift(o),n++}return t>0&&s.length>t&&s.splice(t,s.length-t),s}(t.files,t.settings.limits.count)}setImages(e){let t=this;if(t.settings.isImage){const s=t.container.querySelector("."+t.classes.info);if(s){let i=s.querySelector("."+t.classes.images);i||(i=document.createElement("div"),i.classList.add(t.classes.images),s.prepend(i));for(const t of e)if(this.checkType(t.type)){let e=URL.createObjectURL(t);i.insertAdjacentHTML("beforeEnd",'<span><img src="'+e+'" alt="#"></span>')}}}}setInfoList(e){let t=this;if(t.settings.isInfo){const s=t.container.querySelector("."+t.classes.info);if(s){let i=s.querySelector("."+t.classes.list);i||(i=document.createElement("ul"),i.classList.add(t.classes.list),s.append(i));let n=1;for(const t of e){let e=this.getSizes(t.size);i.insertAdjacentHTML("beforeEnd","<li><span>"+n+".</span><span>"+t.name+"</span><span>["+e+"]</span></li>"),n++}}}}checkType(e){return this.settings.types.includes(e)}getSizes(e,t=!1){const s=this;let i=e/1024,n=i/1024,o=n/1024,a=o/1024,l=0;if(l=i<=1024?i.toFixed(3)+" Kb":i>=1024&&n<=1024?n.toFixed(3)+" Mb":n>=1024&&o<=1024?o.toFixed(3)+" Gb":a.toFixed(3)+" Tb",t){let t=[];e.map((function(e){t.push(e.size)})),l=t.reduce((function(e,t){return e+t})),l=s.getSizes(l)}return l}clear(e=!1){const t=this;let s=t.container.querySelector("."+t.classes.info);if(s){if(t.settings.isImage){let e=s.querySelector("."+t.classes.images);if(e){let t=e.querySelectorAll("span");if(t.length)for(const e of t)e.parentNode.removeChild(e)}}if(t.settings.isInfo){let e=s.querySelector("."+t.classes.list);if(e){let t=e.querySelectorAll("li");if(t.length)for(const e of t)e.parentNode.removeChild(e)}}}if(e){t.container.querySelector('[type="file"]').value="";let e=t.container.querySelectorAll("."+t.classes.fake);if(e.length)for(const t of e)t.remove();s&&s.classList.remove("show"),t.files=[]}}}document.addEventListener("DOMContentLoaded",(function(){let e=document.querySelectorAll(".vg-files");if(e.length)for(const t of e)new n(t)}));const o=n;vg=t})();
//# sourceMappingURL=vgfiles.js.map